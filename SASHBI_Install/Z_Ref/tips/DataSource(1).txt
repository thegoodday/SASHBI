1. web.xml & server.xml & context.xml & SASHBI.xml

2. web.xml
	<resource-ref>
		<res-ref-name>jdbc/SASAPP</res-ref-name>
		<res-type>javax.sql.DataSource</res-type>
		<res-auth>Container</res-auth>
		<res-sharing-scope>Shareable</res-sharing-scope>
	</resource-ref>
	<resource-ref>
		<res-ref-name>jdbc/SASALM</res-ref-name>
		<res-type>javax.sql.DataSource</res-type>
		<res-auth>Container</res-auth>
		<res-sharing-scope>Shareable</res-sharing-scope>
	</resource-ref>

3. server.xml
		PATH : 
			Dev : C:\eclipse_workspace\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\conf\server.xml
			Prd : $SASConfig\Lev1\Web\WebAppServer\SASServer2_1\conf\server.xml
			
		Context : 
			Dev : 
				<GlobalNamingResources>
					<!-- Editable user database that can also be used by
					   UserDatabaseRealm to authenticate users
					-->
					<Resource auth="Container" description="User database that can be updated and saved" factory="org.apache.catalina.users.MemoryUserDatabaseFactory" name="UserDatabase" pathname="conf/tomcat-users.xml" type="org.apache.catalina.UserDatabase"/>
					<Resource auth="Container" driverClassName="org.postgresql.Driver" factory="org.apache.tomcat.jdbc.pool.DataSourceFactory" initialSize="10" jdbcInterceptors="org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer" jmxEnabled="true" maxActive="100" name="sas/jdbc/SharedServices" password="sask@123" testOnBorrow="true" type="javax.sql.DataSource" url="jdbc:postgresql://koryhh5.apac.sas.com:9432/SharedServices" username="SharedServices" validationInterval="30000" validationQuery="select 1"/>
					<Resource auth="Container" driverClassName="org.postgresql.Driver" factory="org.apache.tomcat.jdbc.pool.DataSourceFactory" initialSize="10" jdbcInterceptors="org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer" jmxEnabled="true" maxActive="100" name="sas/jdbc/SASALM" password="sask@123" testOnBorrow="true" type="javax.sql.DataSource" url="jdbc:postgresql://koryhh5.apac.sas.com:9432/SASALM" username="SASALM" validationInterval="30000" validationQuery="select 1"/>
				</GlobalNamingResources>
			  
			Prd :

				<GlobalNamingResources>
					<Resource auth="Container" description="User database that can be updated and saved" factory="org.apache.catalina.users.MemoryUserDatabaseFactory" name="UserDatabase" pathname="conf/tomcat-users.xml" type="org.apache.catalina.UserDatabase"/>
					<Resource auth="Container" description="TransactionManager" factory="com.atomikos.icatch.jta.TransactionManagerFactory" name="TransactionManager" type="com.atomikos.icatch.jta.J2eeTransactionManager"/>
					<Resource auth="Container" mail.smtp.host="a.a" mail.smtp.port="25" name="sas/mail/Session" type="javax.mail.Session"/>
					<Resource auth="Container" driverClassName="org.postgresql.Driver" factory="com.sas.vfabrictcsvr.atomikos.BeanFactory" maxPoolSize="35" minPoolSize="10" name="sas/jdbc/SharedServices" password="${pw.sas.jdbc.SharedServices}" testQuery="select 1" type="com.atomikos.jdbc.nonxa.AtomikosNonXADataSourceBean" uniqueResourceName="sas/jdbc/SharedServices" url="jdbc:postgresql://koredusrv.apac.sas.com:9432/SharedServices" user="SharedServices"/>
					
					<Resource auth="Container" brokerURL="tcp://koredusrv.apac.sas.com:61616" factory="org.apache.activemq.jndi.JNDIReferenceFactory" maxConnections="10" name="sas/jms/EVQueueConnectionFactory" type="org.apache.activemq.pool.AmqJNDIPooledConnectionFactory" useEmbeddedBroker="false"/>
					<Resource auth="Container" description="EVQueue" factory="org.apache.activemq.jndi.JNDIReferenceFactory" name="sas/jms/EVQueue" physicalName="sas.jms.EVQueue" type="org.apache.activemq.command.ActiveMQQueue"/>
					<Resource auth="Container" factory="com.sas.vfabrictcsvr.atomikos.BeanFactory" maxPoolSize="20" name="sas/jms/QueueConnectionFactory" type="com.atomikos.jms.AtomikosConnectionFactoryBean" uniqueResourceName="sas/jms/QueueConnectionFactory" xaConnectionFactoryClassName="org.apache.activemq.ActiveMQXAConnectionFactory" xaProperties.brokerURL="tcp://koredusrv.apac.sas.com:61616"/>
					<Resource auth="Container" description="AlertQueue" factory="org.apache.activemq.jndi.JNDIReferenceFactory" name="sas/jms/AlertQueue" physicalName="sas.jms.AlertQueue" type="org.apache.activemq.command.ActiveMQQueue"/>
					<Resource auth="Container" driverClassName="org.postgresql.Driver" factory="com.sas.vfabrictcsvr.atomikos.BeanFactory" maxPoolSize="100" minPoolSize="10" name="sas/jdbc/Administration" password="${pw.sas.jdbc.Administration}" testQuery="select 1" type="com.atomikos.jdbc.nonxa.AtomikosNonXADataSourceBean" uniqueResourceName="sas/jdbc/Administration" url="jdbc:postgresql://koredusrv.apac.sas.com:9432/Administration" user="adminowner"/>
				</GlobalNamingResources>
				
4. Context.xml
	PATH :
		Dev : C:\eclipse_workspace\SASHBI\WebContent\META-INF\context.xml
		Prd : $SASConfig\Lev1\Web\WebAppServer\SASServer2_1\sas_webapps\sas.hbi.war\META-INF\context.xml
	
	Context :
		Dev :
			<?xml version="1.0"?>
			<Context>
			    <!-- Link global resource to Web application resource -->
			    <ResourceLink global="sas/jdbc/SharedServices" name="jdbc/SASAPP" type="javax.sql.DataSource"/>
			    <ResourceLink global="sas/jdbc/SASHBI" name="jdbc/SASHBI" type="javax.sql.DataSource"/>
			    <ResourceLink global="sas/jdbc/ALMConf" name="jdbc/SASALM" type="javax.sql.DataSource"/>
			</Context>

5. SASHBI.xml
	PATH : $SASConfig\Lev1\Web\WebAppServer\SASServer2_1\conf\Catalina\localhost\SASHBI.xml						
	Context :
		<?xml version="1.0"?>
		<Context docBase="../sas_webapps/sas.hbi.war" path="/SASHBI">
		    <ResourceLink global="sas/jdbc/SharedServices" name="jdbc/SASAPP" type="javax.sql.DataSource"/>
		    <ResourceLink global="sas/jdbc/SASHBI" name="jdbc/SASHBI" type="javax.sql.DataSource"/>
		</Context>


						
5. Test
	C:\eclipse_workspace\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps\SASHBI\sasJNDI_ALMConf.jsp


<%@ page language="java" contentType="text/html; charset=EUC-KR" pageEncoding="EUC-KR"%>
<%@ page language="java" 
    import="
		java.io.*,
		java.sql.*,
		java.util.Properties,
		javax.naming.*,
		javax.sql.*,
		org.apache.log4j.*"
%>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
</head>
<body>

<%
Logger logger = Logger.getLogger("STPRV");
logger.setLevel(Level.DEBUG);

try {	
	Connection SASConn = null;

	Context initContext = new InitialContext();
    Context envCtx = (Context)initContext.lookup("java:comp/env");
    DataSource ds = (DataSource)envCtx.lookup("jdbc/SASALM");
	
	SASConn = ds.getConnection();
	Statement stmt =SASConn.createStatement();
	ResultSet rs = stmt.executeQuery("select id from roll_rep");
	logger.debug("rs : " + rs);
	String resStr = rs.toString();
	logger.debug("resStr : " + resStr);

	out.write ( "<PRE>");
	while (rs.next()) {
		out.write ( rs.getObject(1).toString() + "\t");
		out.write ( "<BR>");
	}
	out.write ( "</PRE>");
	stmt.close();
	SASConn.close();

} catch (Exception e){
	e.printStackTrace();
}
%>

</body>
</html>							